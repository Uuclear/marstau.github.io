---
layout: post
title: android逆向
category: 编程开发
tags: ios jailbreak
keywords: ios
description: 
---


#### ida调试步骤[More](https://www.jianshu.com/p/d2d28920940c)


```
adb push android_server /data/local/tmp/android_server #是用IDA里面的android_server，放入到虚拟机的
adb shell
su root
chmod 777 /data/local/tmp/android_server
./android_server # 启动android_server
```

打开新命令行，开启端口转发

```
adb forward tcp:23946 tcp:23946
```

启动activity

```
am start -D -n com.example.testjniso/com.example.testjniso.MainActivity
```

#### 

```
adb pull /system/lib/libart.so libart.so
```

## Frida环境搭建[More](https://www.jianshu.com/p/646032f34d57)

#### Frida环境搭建

```
adb shell getprop ro.product.cpu.abi #获得x86

frida-server-12.5.2-android-x86.xz

pip install frida
pip install frida-tools
frida-ps -U #获取真机状态
frida-ps -R #获取模拟器状态
```

#### 

```
java -jar baksmali-2.2.2.jar d classes.dex
AXMLPrinter
```

## ERROR

#### `sh: ./android_server: not executable: 32-bit ELF file`

使用真机(arm架构)[More](https://www.bbsmax.com/A/GBJrMR9Wz0/)

#### Failed to load the Frida native extension: DLL load failed[More](https://github.com/frida/frida/issues/231)

```
修改Python34\Lib\site-packages_frida.pyd, 用winhex查找python37.dll,修改为对应ptyhon34.dll(frida 12用的是python37.dll)
```

#### java.lang.UnsatisfiedLinkError: JNI_ERR returned from JNI_OnLoad in "/data/data/im.token.app/.jiagu/libjiagu.so"

加固反编译报错，闪退：
```
Process: im.token.app, PID: 4101
java.lang.UnsatisfiedLinkError: JNI_ERR returned from JNI_OnLoad in "/data/data/im.token.app/.jiagu/libjiagu.so"
```

## TODO

#### 反调试处理

* 干货

```
```

## Reference

* <https://www.jianshu.com/p/f583358afaf5>
* <https://blog.zimperium.com/dissecting-mobile-native-code-packers-case-study/>
* <https://blog.csdn.net/freakishfox/article/details/79752847>
* <https://github.com/dstmath/frida-unpack>
* <https://blog.csdn.net/QQ1084283172/article/details/80956614>
* [反调试对抗](https://www.52pojie.cn/thread-709669-1-1.html)
* <https://blog.csdn.net/jiangwei0910410003/article/details/51769447>
* <https://blog.csdn.net/feibabeibei_beibei/article/details/72773578>